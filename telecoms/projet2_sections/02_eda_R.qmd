---
title: "Exploration des donn√©es ‚Äì QoS mobile 2024"
subtitle: "Voix & Internet mobile ‚Äì France m√©tropolitaine"
format:
  html:
    toc: true
    toc-depth: 3
    number-sections: true
    code-fold: false
execute:
  echo: false
  warning: false
  message: false
---

```{r setup, include=FALSE}
# Packages strictement n√©cessaires
library(readr)
library(dplyr)
library(ggplot2)

knitr::opts_chunk$set(
  echo    = FALSE,
  message = FALSE,
  warning = FALSE
)

# Fonction de nettoyage simple pour les noms de colonnes
clean_names_local <- function(df) {
  nms <- names(df)
  nms <- trimws(nms)
  nms <- tolower(nms)
  nms <- gsub("[^[:alnum:]]+", "_", nms)
  nms <- gsub("_+", "_", nms)
  nms <- gsub("^_|_$", "", nms)
  names(df) <- nms
  df
}

# Liste d'op√©rateurs, pour garder un ordre coh√©rent
operateurs_levels <- c("Orange", "SFR", "Bouygues", "Free")

standardiser_operateur <- function(df) {
  if (!"operator" %in% names(df)) return(df)
  df$operator <- as.character(df$operator)
  df$operator[df$operator == "Bouygues Telecom"] <- "Bouygues"
  df$operator <- factor(df$operator, levels = operateurs_levels)
  df
}

# IMPORTANT :
# 02_eda_R.qmd est dans "telecoms/projet2_sections"
# Le dossier "data" est √† la racine du repo ("nancy-jennifer.github.io")
# ‚Üí il faut remonter DEUX niveaux depuis le working dir :
#   telecoms/projet2_sections -> telecoms -> nancy-jennifer.github.io
base_dir <- "../.."
```

# Contexte et questions d‚Äôanalyse

Ce rapport explore la **qualit√© de service mobile 2024** en France m√©tropolitaine, sur deux volets :

- **Voix** : capacit√© √† √©tablir des appels de mani√®re fiable, sans coupure ni perturbation audible ;
- **Data** : confort d‚Äôusage internet (pages qui se chargent rapidement, d√©bits suffisants).

Les mesures ARCEP proviennent de campagnes de mesures terrain.  
Les objectifs de l‚ÄôEDA :

- identifier les **forces** et **faiblesses** de chaque op√©rateur en Voix et en Data ;
- rep√©rer les **zones √† risque** pour l‚Äôexp√©rience client (habitations vs transports, types de zones) ;
- pr√©parer des **messages cl√©s** exploitables par un recruteur ou un d√©cideur r√©seau.

# Donn√©es et pr√©paration

## ARCEP France ‚Äì Chargement des fichiers

```{r load-data-fr}
globaux_clean <- read_csv(
  file.path(base_dir, "data", "processed", "arcep_2024_indicateurs_globaux_clean.csv")
) |>
  clean_names_local()

voix_hab <- read_csv(
  file.path(base_dir, "data", "processed", "2024_QoS_Metropole_voix_habitations_clean.csv")
) |>
  clean_names_local() |>
  standardiser_operateur()

voix_trans <- read_csv(
  file.path(base_dir, "data", "processed", "2024_QoS_Metropole_voix_transports_clean.csv")
) |>
  clean_names_local() |>
  standardiser_operateur()

data_hab <- read_csv(
  file.path(base_dir, "data", "processed", "2024_QoS_Metropole_data_habitations_clean.csv")
) |>
  clean_names_local() |>
  standardiser_operateur()

data_trans <- read_csv(
  file.path(base_dir, "data", "processed", "2024_QoS_Metropole_data_transports_clean.csv.gz.zip")
) |>
  clean_names_local() |>
  standardiser_operateur()
```

## Harmonisation des structures

```{r standardisation-operateurs}
# Concat Voix (habitations + transports)
voix_all <- bind_rows(
  voix_hab  |> mutate(context = "Habitations"),
  voix_trans |> mutate(context = "Transports")
)

if (!"zone" %in% names(voix_all)) {
  voix_all$zone <- "inconnue"
}
voix_all$zone <- factor(voix_all$zone)

# Concat Data (habitations + transports)
data_all <- bind_rows(
  data_hab  |> mutate(context = "Habitations"),
  data_trans |> mutate(context = "Transports")
)

if (!"zone" %in% names(data_all)) {
  data_all$zone <- "inconnue"
}
data_all$zone <- factor(data_all$zone)
```

---

# Voix ‚Äì fiabilit√© des appels

## Score Voix 0‚Äì100 par op√©rateur

```{r voix-kpi}
# On suppose une variable binaire crspa (1 = appel r√©ussi, 0 = √©chec)
voix_kpi_base <- voix_all |>
  filter(!is.na(crspa)) |>
  group_by(operator, zone, context) |>
  summarise(
    taux_appels_reussis = mean(crspa == 1, na.rm = TRUE),
    n                   = n(),
    .groups             = "drop"
  )

voix_kpi_rescale <- voix_kpi_base |>
  mutate(score_voix_100 = 100 * taux_appels_reussis)

kpi_voix_synthese_operateur <- voix_kpi_rescale |>
  group_by(operator) |>
  summarise(
    score_voix_moyen = weighted.mean(score_voix_100, w = n, na.rm = TRUE),
    n_total          = sum(n),
    .groups          = "drop"
  ) |>
  arrange(desc(score_voix_moyen))
```

```{r voix-kpi-table}
kpi_voix_synthese_operateur
```

Lecture m√©tier (Voix ‚Äì score global) :

- **Score sur 0‚Äì100**, pond√©r√© par le volume de mesures ;
- Classement des op√©rateurs en **fiabilit√© d‚Äô√©tablissement d‚Äôappel**.

```{r voix-kpi-plot, fig.cap="Score Voix (0‚Äì100) par op√©rateur, zone et contexte (habitations vs transports)."}
ggplot(voix_kpi_rescale,
       aes(x = operator, y = score_voix_100, fill = operator)) +
  geom_col() +
  facet_grid(context ~ zone) +
  scale_y_continuous(limits = c(0, 100)) +
  labs(
    title    = "Voix ‚Äì score d‚Äôappels r√©ussis (0‚Äì100)",
    subtitle = "Lecture crois√©e op√©rateur √ó zone √ó contexte",
    x        = NULL,
    y        = "Score Voix (0‚Äì100)"
  ) +
  guides(fill = "none") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

## Zones √† risque Voix

```{r voix-zones-risque}
voix_anomalies <- voix_kpi_rescale |>
  filter(score_voix_100 < 95) |>
  arrange(score_voix_100)

voix_anomalies
```

Lecture m√©tier :

- **< 90** : zones critiques √† adresser en priorit√© (risque fort sur l‚Äôexp√©rience client) ;
- **90‚Äì95** : zones sensibles, √† int√©grer dans un plan d‚Äôam√©lioration 6‚Äì12 mois.

```{r voix-zones-risque-plot-hab, fig.cap="Voix ‚Äì zones √† risque (scores < 95) ‚Äì Habitations."}
voix_anomalies_hab <- voix_anomalies |>
  dplyr::filter(context == "Habitations")

if (nrow(voix_anomalies_hab) > 0) {
  ggplot(
    voix_anomalies_hab,
    aes(x = zone, y = score_voix_100, fill = operator)
  ) +
    geom_col(position = position_dodge(width = 0.7)) +
    scale_y_continuous(limits = c(0, 100)) +
    labs(
      title    = "Voix ‚Äì zones √† risque (scores < 95)",
      subtitle = "Habitations ‚Äì lecture par zone et op√©rateur",
      x        = "Zone",
      y        = "Score Voix (0‚Äì100)",
      fill     = "Op√©rateur"
    ) +
    theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
```

```{r voix-zones-risque-plot-trans, fig.cap="Voix ‚Äì zones √† risque (scores < 95) ‚Äì Transports."}
voix_anomalies_trans <- voix_anomalies |>
  dplyr::filter(context == "Transports")

if (nrow(voix_anomalies_trans) > 0) {
  ggplot(
    voix_anomalies_trans,
    aes(x = zone, y = score_voix_100, fill = operator)
  ) +
    geom_col(position = position_dodge(width = 0.7)) +
    scale_y_continuous(limits = c(0, 100)) +
    labs(
      title    = "Voix ‚Äì zones √† risque (scores < 95)",
      subtitle = "Transports ‚Äì lecture par zone et op√©rateur",
      x        = "Zone",
      y        = "Score Voix (0‚Äì100)",
      fill     = "Op√©rateur"
    ) +
    theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
```

---

# Data ‚Äì confort d‚Äôusage internet mobile

## KPI Data par op√©rateur

```{r data-kpi}
# On suppose :
# - loaded_in_less_10_secondes : indicateur binaire (1 = page charg√©e en < 10 s)
# - bitrate_dl : d√©bit descendant en Mbit/s

data_kpi_prov_operateur <- data_all |>
  group_by(context, operator) |>
  summarise(
    part_pages_10s = mean(loaded_in_less_10_secondes == 1, na.rm = TRUE),
    debit_dl_med   = median(bitrate_dl, na.rm = TRUE),
    n              = n(),
    .groups        = "drop"
  ) |>
  mutate(part_pages_10s_100 = 100 * part_pages_10s)

data_kpi_prov_operateur
```

```{r data-kpi-plot, fig.cap="Internet mobile ‚Äì part des pages charg√©es en moins de 10 s, par op√©rateur et contexte."}
ggplot(data_kpi_prov_operateur,
       aes(x = operator, y = part_pages_10s_100, fill = operator)) +
  geom_col() +
  facet_wrap(~ context) +
  scale_y_continuous(limits = c(0, 100)) +
  labs(
    title    = "Internet mobile ‚Äì pages charg√©es en moins de 10 s",
    subtitle = "Par op√©rateur et par contexte",
    x        = NULL,
    y        = "Part des pages < 10 s (%)"
  ) +
  guides(fill = "none") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

Lecture m√©tier :

- **Part des pages < 10 s** : indicateur direct de **confort de navigation** ;
- **D√©bit descendant m√©dian** : vision de la **capacit√© radio** disponible par op√©rateur.

## Performance Data par zone

```{r data-zone-kpi}
if ("zone" %in% colnames(data_all)) {
  data_env_probe_map <- data_all |>
    group_by(context, operator, zone) |>
    summarise(
      part_pages_10s = mean(loaded_in_less_10_secondes == 1, na.rm = TRUE),
      debit_dl_med   = median(bitrate_dl, na.rm = TRUE),
      n              = n(),
      .groups        = "drop"
    ) |>
    mutate(part_pages_10s_100 = 100 * part_pages_10s)
} else {
  data_env_probe_map <- NULL
}

data_env_probe_map
```

```{r data-zone-plot-hab, fig.cap="Internet mobile ‚Äì performance par zone ‚Äì Habitations."}
if (!is.null(data_env_probe_map) && nrow(data_env_probe_map) > 0) {
  data_hab_zones <- data_env_probe_map |> dplyr::filter(context == "Habitations")

  if (nrow(data_hab_zones) > 0) {
    ggplot(data_hab_zones,
           aes(x = zone, y = part_pages_10s_100, fill = operator)) +
      geom_col(position = position_dodge(width = 0.7)) +
      scale_y_continuous(limits = c(0, 100)) +
      labs(
        title    = "Internet mobile ‚Äì performance par zone",
        subtitle = "Habitations ‚Äì part des pages < 10 s par op√©rateur",
        x        = "Zone",
        y        = "Part des pages < 10 s (%)",
        fill     = "Op√©rateur"
      ) +
      theme(axis.text.x = element_text(angle = 45, hjust = 1))
  }
}
```

```{r data-zone-plot-trans, fig.cap="Internet mobile ‚Äì performance par zone ‚Äì Transports."}
if (!is.null(data_env_probe_map) && nrow(data_env_probe_map) > 0) {
  data_trans_zones <- data_env_probe_map |> dplyr::filter(context == "Transports")

  if (nrow(data_trans_zones) > 0) {
    ggplot(data_trans_zones,
           aes(x = zone, y = part_pages_10s_100, fill = operator)) +
      geom_col(position = position_dodge(width = 0.7)) +
      scale_y_continuous(limits = c(0, 100)) +
      labs(
        title    = "Internet mobile ‚Äì performance par zone",
        subtitle = "Transports ‚Äì part des pages < 10 s par op√©rateur",
        x        = "Zone",
        y        = "Part des pages < 10 s (%)",
        fill     = "Op√©rateur"
      ) +
      theme(axis.text.x = element_text(angle = 45, hjust = 1))
  }
}
```

## Micro-diagnostics cibl√©s

```{r data-micro}
data_micro_diag <- data_kpi_prov_operateur |>
  arrange(part_pages_10s_100) |>
  slice_head(n = 10)

data_micro_diag
```

Lecture m√©tier :

- Top 10 des **combinaisons op√©rateur √ó contexte** les plus fragiles en Data ;
- Entr√©e directe pour un **plan d‚Äôaction Data** (optimisation radio, capacit√© c≈ìur de r√©seau, etc.).

---


# Benchmark international ‚Äì position de la France

L'objectif de cette section est de replacer les performances observ√©es en France dans un cadre international, en mobilisant les bases **ITU / ONU / Banque mondiale** pr√©trait√©es dans le projet.

Les deux indicateurs retenus ici sont :

- **Internet use (% population utilisant internet)**  
- **Mobile broadband subscriptions (abonnements haut-d√©bit mobile pour 100 habitants)**  

Ces deux m√©triques sont les standards internationaux les plus utilis√©s pour comparer la maturit√© num√©rique d‚Äôun pays.

---

```{r load-itu}
itu_int <- read_csv(
  file.path(base_dir, "data", "clean_final", "ITU_FactsFigures2024_final_clean.csv")
) |> clean_names_local()

# On v√©rifie les colonnes pertinentes
names(itu_int)
```

---

## Internet use dans le monde (France vs r√©gions)

```{r itu-internet-use}
internet_use_df <- itu_int |>
  filter(indicator == "internet_use_pct") |>
  select(country, region, internet_use_pct = value)

# Extraction France + moyennes r√©gionales
internet_use_plot <- internet_use_df |>
  mutate(category = ifelse(country == "France", "France", region)) |>
  group_by(category) |>
  summarise(internet_use_pct = mean(internet_use_pct, na.rm = TRUE)) |>
  arrange(desc(internet_use_pct))

internet_use_plot
```

```{r itu-internet-use-plot, fig.cap="Usage d‚Äôinternet ‚Äì France vs r√©gions mondiales (UIT 2024)."}

ggplot(internet_use_plot,
       aes(x = reorder(category, internet_use_pct),
           y = internet_use_pct,
           fill = category == "France")) +
  geom_col() +
  coord_flip() +
  scale_fill_manual(values = c("grey70", "#1f78b4")) +
  labs(
    title = "Usage d‚Äôinternet (% population)",
    subtitle = "Comparaison France vs moyennes r√©gionales ‚Äì ITU 2024",
    x = NULL,
    y = "% de la population"
  ) +
  guides(fill = "none")
```

üü¶ Lecture m√©tier :

- La France se compare directement aux r√©gions mondiales normalis√©es ITU.
- La position de la France indique son **niveau de maturit√© num√©rique**.
- Cet indicateur contextualise la QoS ARCEP : fort usage ‚Üí niveau d‚Äôexigence client √©lev√©.

---

## Abonnements mobile broadband (France vs r√©gions)

```{r itu-mbb}
mbb_df <- itu_int |>
  filter(indicator == "mobile_broadband_subs_per_100") |>
  select(country, region, mbb = value)

mbb_plot <- mbb_df |>
  mutate(category = ifelse(country == "France", "France", region)) |>
  group_by(category) |>
  summarise(mbb = mean(mbb, na.rm = TRUE)) |>
  arrange(desc(mbb))

mbb_plot
```

```{r itu-mbb-plot, fig.cap="Abonnements mobile broadband ‚Äì France vs r√©gions mondiales (UIT 2024)."}

ggplot(mbb_plot,
       aes(x = reorder(category, mbb),
           y = mbb,
           fill = category == "France")) +
  geom_col() +
  coord_flip() +
  scale_fill_manual(values = c("grey70", "#33a02c")) +
  labs(
    title = "Abonnements haut-d√©bit mobile (pour 100 habitants)",
    subtitle = "Comparaison France vs r√©gions ‚Äì ITU 2024",
    x = NULL,
    y = "Abonnements / 100 habitants"
  ) +
  guides(fill = "none")
```

üü© Lecture m√©tier :

- Cet indicateur refl√®te l‚Äô**intensit√© d‚Äôusage** du mobile broadband.
- Plus la p√©n√©tration est forte, plus la pression est √©lev√©e sur les r√©seaux Data.
- Utile pour expliquer les diff√©rences entre **performance ARCEP** et **attentes du march√©**.

---

## Synth√®se Benchmark

- La France se situe √† un niveau **√©lev√© d‚Äôusage d‚Äôinternet**, comparable aux r√©gions avanc√©es.  
- Le niveau d‚Äôabonnements mobile broadband place la France dans un groupe **mature**, avec une demande forte.  
- Conjugu√© aux donn√©es ARCEP, ce benchmark montre que **la QoS mobile fran√ßaise op√®re dans un contexte d‚Äôusage intensif**, ce qui rend la comparaison op√©rateurs encore plus pertinente.


## Usage d‚ÄôInternet ‚Äì grandes r√©gions (UIT 2024)

```{r itu_internet_use, fig.cap="Usage d‚ÄôInternet ‚Äì grandes r√©gions (UIT 2024)."}
internet_region_2024 <- itu_2024 |>
  dplyr::filter(
    grepl("internet", indicator, ignore.case = TRUE),
    grepl("use", indicator, ignore.case = TRUE),
    region %in% regions_focus
  ) |>
  dplyr::group_by(region) |>
  dplyr::summarise(
    internet_use_pct = mean(value, na.rm = TRUE),
    .groups = "drop"
  ) |>
  dplyr::arrange(internet_use_pct) |>
  dplyr::mutate(region = factor(region, levels = region))

if (nrow(internet_region_2024) > 0) {
  ggplot(
    internet_region_2024,
    aes(x = internet_use_pct, y = region, fill = region == "Europe")
  ) +
    geom_col() +
    labs(
      title    = "Usage d‚ÄôInternet ‚Äì position de l‚ÄôEurope",
      subtitle = "Comparaison avec les grandes r√©gions du monde (UIT 2024)",
      x        = "Part de la population utilisant Internet (%)",
      y        = NULL
    ) +
    guides(fill = "none")
}
```

### Lecture m√©tier

- L‚ÄôEurope fait partie des **r√©gions les plus connect√©es au monde**.  
- La France, en tant que pays europ√©en, s‚Äôinscrit donc dans un **√©cosyst√®me globalement avanc√©** en termes de p√©n√©tration internet.

---

## Abonnements mobile broadband pour 100 habitants ‚Äì grandes r√©gions (UIT 2024)

```{r itu_broadband, fig.cap="Abonnements mobile broadband pour 100 habitants ‚Äì grandes r√©gions (UIT 2024)."}
broadband_region_2024 <- itu_2024 |>
  dplyr::filter(
    grepl("broadband", indicator, ignore.case = TRUE),
    grepl("subs", indicator, ignore.case = TRUE),
    region %in% regions_focus
  ) |>
  dplyr::group_by(region) |>
  dplyr::summarise(
    broadband_per_100 = mean(value, na.rm = TRUE),
    .groups = "drop"
  ) |>
  dplyr::arrange(broadband_per_100) |>
  dplyr::mutate(region = factor(region, levels = region))

if (nrow(broadband_region_2024) > 0) {
  ggplot(
    broadband_region_2024,
    aes(x = broadband_per_100, y = region, fill = region == "Europe")
  ) +
    geom_col() +
    labs(
      title    = "Abonnements mobile broadband (par 100 habitants)",
      subtitle = "Europe vs autres r√©gions (UIT 2024)",
      x        = "Abonnements / 100 habitants",
      y        = NULL
    ) +
    guides(fill = "none")
}
```

### Lecture m√©tier

- L‚ÄôEurope se situe **nettement au-dessus de la moyenne mondiale**.
- Cela indique un parc mobile haut-d√©bit **dense**, coh√©rent avec les performances Data observ√©es en France.

---

---

# Recommandations & synth√®se pour d√©cideurs

Cette EDA met en √©vidence :

- en **Voix**, un score global √©lev√© mais avec des **poches de risque** sur certains couples *op√©rateur √ó zone √ó contexte* ;
- en **Data**, des √©carts plus marqu√©s entre op√©rateurs, en particulier sur :
  - la **part des pages < 10 s** ;
  - les zones o√π la performance se d√©grade fortement.

Pour un d√©cideur r√©seau, les messages cl√©s sont :

- une vision structur√©e des performances Voix / Data par op√©rateur et par environnement (habitations vs transports, zones denses vs rurales, etc.) ;
- une cartographie claire des **zones √† risque**, priorisables dans un plan d‚Äôaction ;
- des indicateurs align√©s avec un **benchmark international** (UIT / Banque mondiale), permettant de positionner la France dans le paysage mondial.

Recommandations op√©rationnelles (exemples structurants) :

- **Voix**
  - cibler en priorit√© les couples *op√©rateur √ó zone* dont le score Voix est < 90 ;
  - v√©rifier, pour ces zones, la qualit√© radio (couverture outdoor/indoor, interf√©rences, dimensionnement c≈ìur de r√©seau) ;
  - mettre en place un suivi mensuel des KPI Voix par zone, avec alerte automatique sous un certain seuil.

- **Data**
  - fixer un objectif de **part des pages < 10 s** (ex. ‚â• 95 %) par op√©rateur et par contexte ;
  - prioriser les zones o√π la part des pages < 10 s et le d√©bit m√©dian chutent simultan√©ment ;
  - utiliser la table de **micro-diagnostics** comme backlog pour les actions d‚Äôoptimisation radio.

- **Pilotage & communication**
  - consolider ces KPI dans un **tableau de bord ex√©cutif** (Voix / Data / benchmark international) ;
  - formaliser un **plan 90 jours / 12 mois** avec indicateurs cibles, responsables et jalons ;
  - communiquer r√©guli√®rement les progr√®s aux parties prenantes (√©quipes techniques, marketing, r√©gulation).

En r√©sum√©, ce fichier illustre ma capacit√© √† :

- structurer une **EDA t√©l√©com compl√®te** (ingestion, pr√©paration, KPI, visualisations, zones √† risque) ;
- relier des **mesures terrain** √† des **standards internationaux** ;
- traduire les r√©sultats en **recommandations r√©seau concr√®tes**, lisibles pour un d√©cideur non technique.
