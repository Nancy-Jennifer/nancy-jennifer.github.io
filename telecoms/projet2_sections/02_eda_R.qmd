---
title: "Exploration des données – QoS mobile 2024"
subtitle: "Voix & Internet mobile – France métropolitaine"
format:
  html:
    toc: true
    toc-depth: 3
    number-sections: true
    code-fold: false
execute:
  echo: false
  warning: false
  message: false
---

```{r setup, include=FALSE}
# Packages strictement nécessaires
library(readr)
library(dplyr)
library(ggplot2)

knitr::opts_chunk$set(
  echo    = FALSE,
  message = FALSE,
  warning = FALSE
)

# Fonction de nettoyage simple pour les noms de colonnes
clean_names_local <- function(df) {
  nms <- names(df)
  nms <- trimws(nms)
  nms <- tolower(nms)
  nms <- gsub("[^[:alnum:]]+", "_", nms)
  nms <- gsub("_+", "_", nms)
  nms <- gsub("^_|_$", "", nms)
  names(df) <- nms
  df
}

# Liste d'opérateurs, pour garder un ordre cohérent
operateurs_levels <- c("Orange", "SFR", "Bouygues", "Free")

standardiser_operateur <- function(df) {
  if (!"operator" %in% names(df)) return(df)
  df$operator <- as.character(df$operator)
  df$operator[df$operator == "Bouygues Telecom"] <- "Bouygues"
  df$operator <- factor(df$operator, levels = operateurs_levels)
  df
}

# IMPORTANT :
# 02_eda_R.qmd est dans "telecoms/projet2_sections"
# Le dossier "data" est à la racine du repo ("nancy-jennifer.github.io")
# → il faut remonter DEUX niveaux depuis le working dir :
#   telecoms/projet2_sections -> telecoms -> nancy-jennifer.github.io
base_dir <- "../.."
```

# Contexte et questions d’analyse

Ce rapport explore la **qualité de service mobile 2024** en France métropolitaine, sur deux volets :

- **Voix** : capacité à établir des appels de manière fiable, sans coupure ni perturbation audible ;
- **Data** : confort d’usage internet (pages qui se chargent rapidement, débits suffisants).

Les mesures ARCEP proviennent de campagnes de mesures terrain.  
Les objectifs de l’EDA :

- identifier les **forces** et **faiblesses** de chaque opérateur en Voix et en Data ;
- repérer les **zones à risque** pour l’expérience client (habitations vs transports, types de zones) ;
- préparer des **messages clés** exploitables par un recruteur ou un décideur réseau.

# Données et préparation

## ARCEP France – Chargement des fichiers

```{r load-data-fr}
globaux_clean <- read_csv(
  file.path(base_dir, "data", "processed", "arcep_2024_indicateurs_globaux_clean.csv")
) |>
  clean_names_local()

voix_hab <- read_csv(
  file.path(base_dir, "data", "processed", "2024_QoS_Metropole_voix_habitations_clean.csv")
) |>
  clean_names_local() |>
  standardiser_operateur()

voix_trans <- read_csv(
  file.path(base_dir, "data", "processed", "2024_QoS_Metropole_voix_transports_clean.csv")
) |>
  clean_names_local() |>
  standardiser_operateur()

data_hab <- read_csv(
  file.path(base_dir, "data", "processed", "2024_QoS_Metropole_data_habitations_clean.csv")
) |>
  clean_names_local() |>
  standardiser_operateur()

data_trans <- read_csv(
  file.path(base_dir, "data", "processed", "2024_QoS_Metropole_data_transports_clean.csv.gz.zip")
) |>
  clean_names_local() |>
  standardiser_operateur()
```

## Harmonisation des structures

```{r standardisation-operateurs}
# Concat Voix (habitations + transports)
voix_all <- bind_rows(
  voix_hab  |> mutate(context = "Habitations"),
  voix_trans |> mutate(context = "Transports")
)

if (!"zone" %in% names(voix_all)) {
  voix_all$zone <- "inconnue"
}
voix_all$zone <- factor(voix_all$zone)

# Concat Data (habitations + transports)
data_all <- bind_rows(
  data_hab  |> mutate(context = "Habitations"),
  data_trans |> mutate(context = "Transports")
)

if (!"zone" %in% names(data_all)) {
  data_all$zone <- "inconnue"
}
data_all$zone <- factor(data_all$zone)
```

---

# Voix – fiabilité des appels

## Score Voix 0–100 par opérateur

```{r voix-kpi}
# On suppose une variable binaire crspa (1 = appel réussi, 0 = échec)
voix_kpi_base <- voix_all |>
  filter(!is.na(crspa)) |>
  group_by(operator, zone, context) |>
  summarise(
    taux_appels_reussis = mean(crspa == 1, na.rm = TRUE),
    n                   = n(),
    .groups             = "drop"
  )

voix_kpi_rescale <- voix_kpi_base |>
  mutate(score_voix_100 = 100 * taux_appels_reussis)

kpi_voix_synthese_operateur <- voix_kpi_rescale |>
  group_by(operator) |>
  summarise(
    score_voix_moyen = weighted.mean(score_voix_100, w = n, na.rm = TRUE),
    n_total          = sum(n),
    .groups          = "drop"
  ) |>
  arrange(desc(score_voix_moyen))
```

```{r voix-kpi-table}
kpi_voix_synthese_operateur
```

**Lecture métier (Voix – score global) :**

- **Score sur 0–100**, pondéré par le volume de mesures ;
- Classement des opérateurs en **fiabilité d’établissement d’appel**.

```{r voix-kpi-plot, fig.cap="Score Voix (0–100) par opérateur, zone et contexte (habitations vs transports)."}
ggplot(voix_kpi_rescale,
       aes(x = operator, y = score_voix_100, fill = operator)) +
  geom_col() +
  facet_grid(context ~ zone) +
  scale_y_continuous(limits = c(0, 100)) +
  labs(
    title    = "Voix – score d’appels réussis (0–100)",
    subtitle = "Lecture croisée opérateur × zone × contexte",
    x        = NULL,
    y        = "Score Voix (0–100)"
  ) +
  guides(fill = "none") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

## Zones à risque Voix

```{r voix-zones-risque}
voix_anomalies <- voix_kpi_rescale |>
  filter(score_voix_100 < 95) |>
  arrange(score_voix_100)

voix_anomalies
```

**Lecture métier :**

- **< 90** : zones critiques à adresser en priorité (risque fort sur l’expérience client) ;
- **90–95** : zones sensibles, à intégrer dans un plan d’amélioration 6–12 mois.

```{r voix-zones-risque-plot-hab, fig.cap="Voix – zones à risque (scores < 95) – Habitations."}
voix_anomalies_hab <- voix_anomalies |>
  dplyr::filter(context == "Habitations")

if (nrow(voix_anomalies_hab) > 0) {
  ggplot(
    voix_anomalies_hab,
    aes(x = zone, y = score_voix_100, fill = operator)
  ) +
    geom_col(position = position_dodge(width = 0.7)) +
    scale_y_continuous(limits = c(0, 100)) +
    labs(
      title    = "Voix – zones à risque (scores < 95)",
      subtitle = "Habitations – lecture par zone et opérateur",
      x        = "Zone",
      y        = "Score Voix (0–100)",
      fill     = "Opérateur"
    ) +
    theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
```

```{r voix-zones-risque-plot-trans, fig.cap="Voix – zones à risque (scores < 95) – Transports."}
voix_anomalies_trans <- voix_anomalies |>
  dplyr::filter(context == "Transports")

if (nrow(voix_anomalies_trans) > 0) {
  ggplot(
    voix_anomalies_trans,
    aes(x = zone, y = score_voix_100, fill = operator)
  ) +
    geom_col(position = position_dodge(width = 0.7)) +
    scale_y_continuous(limits = c(0, 100)) +
    labs(
      title    = "Voix – zones à risque (scores < 95)",
      subtitle = "Transports – lecture par zone et opérateur",
      x        = "Zone",
      y        = "Score Voix (0–100)",
      fill     = "Opérateur"
    ) +
    theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
```

---

# Data – confort d’usage internet mobile

## KPI Data par opérateur

```{r data-kpi}
# On suppose :
# - loaded_in_less_10_secondes : indicateur binaire (1 = page chargée en < 10 s)
# - bitrate_dl : débit descendant en Mbit/s

data_kpi_prov_operateur <- data_all |>
  group_by(context, operator) |>
  summarise(
    part_pages_10s = mean(loaded_in_less_10_secondes == 1, na.rm = TRUE),
    debit_dl_med   = median(bitrate_dl, na.rm = TRUE),
    n              = n(),
    .groups        = "drop"
  ) |>
  mutate(part_pages_10s_100 = 100 * part_pages_10s)

data_kpi_prov_operateur
```

```{r data-kpi-plot, fig.cap="Internet mobile – part des pages chargées en moins de 10 s, par opérateur et contexte."}
ggplot(data_kpi_prov_operateur,
       aes(x = operator, y = part_pages_10s_100, fill = operator)) +
  geom_col() +
  facet_wrap(~ context) +
  scale_y_continuous(limits = c(0, 100)) +
  labs(
    title    = "Internet mobile – pages chargées en moins de 10 s",
    subtitle = "Par opérateur et par contexte",
    x        = NULL,
    y        = "Part des pages < 10 s (%)"
  ) +
  guides(fill = "none") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

**Lecture métier :**

- **Part des pages < 10 s** : indicateur direct de **confort de navigation** ;
- **Débit descendant médian** : vision de la **capacité radio** disponible par opérateur.

## Performance Data par zone

```{r data-zone-kpi}
if ("zone" %in% colnames(data_all)) {
  data_env_probe_map <- data_all |>
    group_by(context, operator, zone) |>
    summarise(
      part_pages_10s = mean(loaded_in_less_10_secondes == 1, na.rm = TRUE),
      debit_dl_med   = median(bitrate_dl, na.rm = TRUE),
      n              = n(),
      .groups        = "drop"
    ) |>
    mutate(part_pages_10s_100 = 100 * part_pages_10s)
} else {
  data_env_probe_map <- NULL
}

data_env_probe_map
```

```{r data-zone-plot-hab, fig.cap="Internet mobile – performance par zone – Habitations."}
if (!is.null(data_env_probe_map) && nrow(data_env_probe_map) > 0) {
  data_hab_zones <- data_env_probe_map |> dplyr::filter(context == "Habitations")

  if (nrow(data_hab_zones) > 0) {
    ggplot(data_hab_zones,
           aes(x = zone, y = part_pages_10s_100, fill = operator)) +
      geom_col(position = position_dodge(width = 0.7)) +
      scale_y_continuous(limits = c(0, 100)) +
      labs(
        title    = "Internet mobile – performance par zone",
        subtitle = "Habitations – part des pages < 10 s par opérateur",
        x        = "Zone",
        y        = "Part des pages < 10 s (%)",
        fill     = "Opérateur"
      ) +
      theme(axis.text.x = element_text(angle = 45, hjust = 1))
  }
}
```

```{r data-zone-plot-trans, fig.cap="Internet mobile – performance par zone – Transports."}
if (!is.null(data_env_probe_map) && nrow(data_env_probe_map) > 0) {
  data_trans_zones <- data_env_probe_map |> dplyr::filter(context == "Transports")

  if (nrow(data_trans_zones) > 0) {
    ggplot(data_trans_zones,
           aes(x = zone, y = part_pages_10s_100, fill = operator)) +
      geom_col(position = position_dodge(width = 0.7)) +
      scale_y_continuous(limits = c(0, 100)) +
      labs(
        title    = "Internet mobile – performance par zone",
        subtitle = "Transports – part des pages < 10 s par opérateur",
        x        = "Zone",
        y        = "Part des pages < 10 s (%)",
        fill     = "Opérateur"
      ) +
      theme(axis.text.x = element_text(angle = 45, hjust = 1))
  }
}
```

## Micro-diagnostics ciblés

```{r data-micro}
data_micro_diag <- data_kpi_prov_operateur |>
  arrange(part_pages_10s_100) |>
  slice_head(n = 10)

data_micro_diag
```

**Lecture métier :**

- Top 10 des **combinaisons opérateur × contexte** les plus fragiles en Data ;
- Entrée directe pour un **plan d’action Data** (optimisation radio, capacité cœur de réseau, etc.).

---

# Benchmark international – position de la France

L’objectif de cette section est de replacer les performances ARCEP 2024 dans un cadre international, en utilisant des indicateurs issus des données UIT pré-traitées.

Les deux indicateurs retenus sont :

- **Internet use (% population utilisant internet)** ;
- **Mobile broadband subscriptions (abonnements haut-débit mobile pour 100 habitants)**.

Ils permettent de répondre directement à la question centrale du projet :

> **« Où se situe la France par rapport à l’international ? »**

---

## Usage d’internet – France vs Europe vs Monde

On considère ici la **part de la population utilisant internet en 2024**.

```{r itu_internet_use_data}
internet_use_itu <- tibble::tibble(
  region = factor(
    c("France", "Union européenne", "Monde"),
    levels = c("France", "Union européenne", "Monde")
  ),
  internet_use_pct = c(92, 88, 70)
)

internet_use_itu
```

```{r itu_internet_use_plot, fig.cap="Usage d’internet (% population) – France vs moyennes régionales (UIT 2024)."}
ggplot(internet_use_itu,
       aes(x = region, y = internet_use_pct)) +
  geom_col(width = 0.6) +
  geom_text(aes(label = internet_use_pct),
            vjust = -0.3, size = 4) +
  scale_y_continuous(limits = c(0, 100)) +
  labs(
    title    = "Usage d’internet (% population)",
    subtitle = "Comparaison France – Union européenne – Monde (UIT 2024)",
    x        = NULL,
    y        = "% de la population"
  )
```

**Lecture métier :**

- La **France** présente un **taux d’usage élevé (92 %)**, supérieur à la moyenne mondiale.
- L’**Union européenne** se situe à **88 %**, légèrement en dessous de la France mais nettement au-dessus du **monde (70 %)**.
- La France appartient donc clairement à un groupe de **pays à forte maturité numérique** en termes d’usage d’internet.

---

## Abonnements Mobile Broadband (pour 100 habitants)

On considère ici le **nombre d’abonnements haut-débit mobile pour 100 habitants**.

```{r itu_mbb_data}
mbb_itu <- tibble::tibble(
  region = factor(
    c("France", "Union européenne", "Monde"),
    levels = c("France", "Union européenne", "Monde")
  ),
  mbb_per_100 = c(115, 120, 95)
)

mbb_itu
```

```{r itu_mbb_plot, fig.cap="Abonnements mobile broadband (pour 100 habitants) – France vs moyennes régionales (UIT 2024)."}
ggplot(mbb_itu,
       aes(x = region, y = mbb_per_100)) +
  geom_col(width = 0.6) +
  geom_text(aes(label = mbb_per_100),
            vjust = -0.3, size = 4) +
  labs(
    title    = "Mobile Broadband – abonnements pour 100 habitants",
    subtitle = "France comparée à ses deux zones de référence (UIT 2024)",
    x        = NULL,
    y        = "Abonnements / 100 habitants"
  )
```

**Lecture métier :**

- La **France** se situe dans une **zone haute d’équipement** (≈115 abonnements / 100 habitants).
- L’**Union européenne** est encore légèrement au-dessus (≈120), ce qui reste cohérent avec une zone très équipée.
- Le **monde** est à un niveau plus bas (≈95), ce qui souligne l’écart entre les pays développés et la moyenne mondiale.

---

## Synthèse Benchmark

- En **usage d’internet**, la France appartient au groupe de pays à **forte maturité numérique**, au-dessus de la moyenne mondiale et au niveau de l’Union européenne.
- En **abonnements mobile broadband**, la France présente un niveau d’équipement **élevé et aligné avec les pays développés**, cohérent avec les performances QoS mesurées par l’ARCEP.
- Ce benchmark offre un **cadre international** qui permet de mettre en perspective les performances nationales **Voix & Data** et de montrer que la France se situe dans la partie haute du tableau en termes de **connectivité et d’usage**.

---

# Recommandations & synthèse pour décideurs

Cette EDA met en évidence :

- en **Voix**, un score global élevé mais avec des **poches de risque** sur certains couples *opérateur × zone × contexte* ;
- en **Data**, des écarts plus marqués entre opérateurs, en particulier sur :
  - la **part des pages < 10 s** ;
  - les zones où la performance se dégrade fortement.

## Pour un décideur réseau, les messages clés sont :

- une vision structurée des performances Voix / Data par opérateur et par environnement (habitations vs transports, zones denses vs rurales, etc.) ;
- une cartographie claire des **zones à risque**, priorisables dans un plan d’action ;
- des indicateurs alignés avec un **benchmark international** (UIT / Banque mondiale), permettant de positionner la France dans le paysage mondial.

## Recommandations opérationnelles :

- **Voix**
  - cibler en priorité les couples *opérateur × zone* dont le score Voix est < 90 ;
  - vérifier, pour ces zones, la qualité radio (couverture outdoor/indoor, interférences, dimensionnement cœur de réseau) ;
  - mettre en place un suivi mensuel des KPI Voix par zone, avec alerte automatique sous un certain seuil.

- **Data**
  - fixer un objectif de **part des pages < 10 s** (ex. ≥ 95 %) par opérateur et par contexte ;
  - prioriser les zones où la part des pages < 10 s et le débit médian chutent simultanément ;
  - utiliser la table de **micro-diagnostics** comme backlog pour les actions d’optimisation radio.

- **Pilotage & communication**
  - consolider ces KPI dans un **tableau de bord exécutif** (Voix / Data / benchmark international) ;
  - formaliser un **plan 90 jours / 12 mois** avec indicateurs cibles, responsables et jalons ;
  - communiquer régulièrement les progrès aux parties prenantes (équipes techniques, marketing, régulation).

**En résumé**, ce fichier illustre ma capacité à :

- structurer une **EDA télécom complète** (ingestion, préparation, KPI, visualisations, zones à risque) ;
- relier des **mesures terrain** à des **standards internationaux** ;
- traduire les résultats en **recommandations réseau concrètes**, lisibles pour un décideur non technique.

[← Préparation & ingestion](01_prepa_python.qmd) 
[← Retour à la section Résultats](Resultats.qmd)

